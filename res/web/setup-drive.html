<div style="margin:60px;">
  <h2>Setup Drive</h2>
  <ul id="setup-drive-list">
    <script>
      var curVol = MC.db.getProp(MC.kDbKeyDriveVol);
      var drives = MC.toJsArray(MC.storage.getVolumes());
      for(var i = 0; i < drives.length; i++) {
        var props = drives[i].split(',');
        var vol = props[0];
        if(vol.length != 0) {
          var path = props[1];
          var html = '<li vol="' + vol + '" onclick="MC.ui.list.setSelected(this);"';
          html+= ' class="' + vol == curVol ? 'selected' : 'normal' + '"';
          html+= '>';
          html+= '<b>' + vol + '</b>&nbsp;' + path;
          html+= '</li>';
          MC.write(html);
        }
      }
    </script>
  </ul>
  <br />
  <input type="button" value="NEXT" onclick="onSaveDriveSettings();" />    
</div>
<script>
function onSaveDriveSettings() { 
  var item = MC.ui.list.getSelected('setup-drive-list');
  if(item == null) {
    MC.notify('Select a drive to use with Mobicast.');
  } else {
    var vol = item.getAttribute('vol');
    MC.db.setProp(MC.kDbKeyDriveVol, vol);
    if(MC.mountStorage(vol)) {
      MC.notify('Storage "' + vol + '" is ready for use.');
      MC.setup.next();
    } else {
      MC.notify('Failed to mount drive with volume label ' + vol);
    }
  }
}
</script>
